/* ---------- Layout: center main column; ToC at left without affecting centering ---------- */

/* ---------- Tokens ---------- */
:root{
  /* Colors */
  --fg:#151515; --bg:#fff; --muted:#6b6b6b; --ink:#0a0a0a; --border:#e6e6e6; --link:#1a73e8;

  /* Font stacks — system-first, no external fonts needed */
  --serif: Georgia, "Iowan Old Style", "Times New Roman", serif;
  --sans: "Iowan Old Style", system-ui, sans-serif;
  --mono: "SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, "Courier New", monospace;

  /* Widths, layout, and gaps untouched */
  --measure:78ch;
  --tocw:240px;
  --gap:2rem;

  /* Leading */
  --line:1.68;     /* body */
  --hline:1.18;    /* headings */

  /* Fluid type scale (≈1.22 ratio) */
  --step--1: clamp(.95rem, .92rem + .2vw, 1.02rem);
  --step-0: clamp(1rem, .96rem + .35vw, 1.125rem);       /* body base ≈ 16–18px */
  --step-1: clamp(1.125rem, 1.06rem + .6vw, 1.35rem);    /* small subheads */
  --step-2: clamp(1.35rem, 1.2rem + 1vw, 1.7rem);        /* h4 */
  --step-3: clamp(1.7rem, 1.4rem + 1.6vw, 2.1rem);       /* h3 */
  --step-4: clamp(2.1rem, 1.8rem + 2.2vw, 2.6rem);       /* h2 */
  --step-5: clamp(6rem, 3rem + 5vw, 5.2rem);         /* title */
}

*{box-sizing:border-box}
html{scroll-behavior:smooth}
@media (prefers-reduced-motion: reduce){ html{scroll-behavior:auto} }

body{
  margin:0;
  color:var(--fg);
  background:var(--bg);
  font-family:var(--serif);
  font-weight:400;
  font-size:var(--step-0);
  line-height:var(--line);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  text-rendering:optimizeLegibility;
  font-kerning:normal;
  font-variant-ligatures:common-ligatures;
  font-variant-numeric:oldstyle-nums;
  text-wrap:pretty;
  hanging-punctuation:first allow-end;
}

/* ---------- Container ---------- */
.container{
  width:100%;
  max-width:min(1600px, 100vw);
  margin:0 auto;
  padding:1rem clamp(10px, 1.6vw, 18px) 4rem;
}

/* ---------- Main grid ---------- */
main{
  display:grid;
  grid-template-columns:
    minmax(calc(var(--tocw) + var(--gap)), 1fr)
    minmax(0, var(--measure))
    minmax(0, 1fr);
  column-gap:0;
  align-items:start;
}

/* Placement */
.article-header{
  grid-column:2; grid-row:1;
  width:100%;
  text-align:left;
  margin-bottom:.5rem;
}
.toc{
  grid-column:1; grid-row:2;
  justify-self:end;
  width:var(--tocw);
  margin-right:var(--gap);
  overflow-x:visible;
  z-index:1;
}
article{
  grid-column:2; grid-row:2;
  width:100%;
}

/* ---------- Mobile stack ---------- */
@media (max-width:1200px){
  main{ grid-template-columns:1fr; }
  .article-header{ grid-column:1; grid-row:1; }
  .toc{
    grid-column:1; grid-row:2;
    justify-self:start;
    width:auto;
    margin:0 0 1rem 0;
    position:static !important;
    top:auto !important;
    max-height:none !important;
    overflow:visible !important;
  }
  article{ grid-column:1; grid-row:3; }
}

/* ---------- Title & subtitle ---------- */
.article-title{
  font-family:var(--sans);
  font-size:var(--step-5);
  font-weight:700;
  line-height:1.06;
  color:var(--ink);
  letter-spacing:-.015em;
  margin:clamp(1.8rem,5vw,3.5rem) 0 .6rem 0;
  text-wrap:balance;
}
.article-subtitle{
  font-family:var(--sans);
  font-size:clamp(1.5em,.9rem + .4vw,1.15rem);
  color:var(--muted);
  line-height:1.45;
  font-weight:400;
  font-style:italic;
  margin:0 0 .25rem;
  text-wrap:balance;
}

/* ---------- ToC ---------- */
.toc{
  position:sticky;
  top:3.5rem;
  max-height:calc(100vh - 4rem);
  overflow:auto;
  padding-right:.15rem;
}
.toc-title{
  font-size:1rem;
  text-transform:uppercase;
  letter-spacing:.12em;
  color:var(--muted);
  margin:.25rem 0 .5rem;
  font-variant-caps:all-small-caps;
}
.toc-nav ul{
  list-style:none;
  margin:0;
  padding-left:.75rem;
  font-size:.92rem;
  line-height:1.7;
}
.toc-nav > ul{padding-left:0}
.toc a{text-decoration:none;color:inherit}
.toc a:hover{text-decoration:underline}
.toc a.active{color:var(--link);font-weight:600;text-decoration:none}

:where(h2,h3,h4,h5,h6)[id]{scroll-margin-top:24px}
.toc-sentinel{position:relative;height:1px;margin:0;padding:0;overflow:hidden}

/* ---------- Typography ---------- */
h1,h2,h3,h4,h5,h6{
  font-family:var(--sans);
  font-weight:700;
  line-height:var(--hline);
  color:var(--ink);
  margin:1.6rem 0 .6em;
  letter-spacing:-.01em;
  text-wrap:balance;
}
h1{font-size:clamp(2rem,1.4rem + 3vw,3rem)}
h2{font-size:var(--step-4)}
h3{font-size:var(--step-3)}
h4{font-size:var(--step-2)}
h5{font-size:var(--step-1)}
h6{font-size:var(--step--1);text-transform:uppercase;letter-spacing:.06em}

p,ul,ol,figure,blockquote,pre,table{margin:1.05em 0}
strong{font-weight:700}
em{font-style:italic}
small{font-size:.9em;color:var(--muted)}
hr{border:0;border-top:1px solid var(--border);margin:2.25rem 0}

/* Drop cap */
article>p:first-of-type::first-letter,
article h2+p::first-letter{
  font-size:3.1em;
  float:left;
  line-height:0.9;
  margin:0.05em 0.12em 0 0;
  font-weight:700;
  font-family:var(--serif);
}

/* Links */
a{color:var(--link);text-decoration:none;text-underline-offset:2px}
a:hover{text-decoration:underline}

/* Blockquote */
blockquote{
  border-left:3px solid var(--border);
  padding:.55rem 1rem;
  background:linear-gradient(180deg,#fafafa,transparent 80%);
  border-radius:0 10px 10px 0;
  color:#333;
  font-size:var(--step--2);
  line-height:1.6;
  hanging-punctuation:first allow-end;
}

/* Code */
code,kbd,samp{
  font-family:var(--mono);
  font-size:.98em;
  line-height:1.55;
  background:#f7f7f9;
  padding:.15em .35em;
  border-radius:6px;
  border:1px solid #eee;
}
pre{
  overflow:auto;
  padding:1rem;
  background:#0a0a0a;
  color:#f5f5f5;
  border-radius:10px;
  font-family:var(--mono);
  font-size:.95rem;
  line-height:1.55;
}
pre code{background:transparent;border:0;padding:0;font-size:inherit}

/* Media */
article img,article video,.content img,.content video,img{
  max-width:80%;
  height:auto;
  display:block;
  margin:0 auto;
}

/* YouTube embeds */
article div[style*="padding-bottom"],.content div[style*="padding-bottom"]{
  padding-bottom:0!important;
  height:auto!important;
  position:static!important;
}
article iframe,.content iframe{
  max-width:80%;
  width:100%!important;
  height:auto!important;
  aspect-ratio:16/9;
  display:block;
  margin:1em auto;
  position:static!important;
}
article p:has(> iframe:only-child),.content p:has(> iframe:only-child){margin:1em 0}

figure{margin:2rem 0}
figcaption{
  font-family:var(--sans);
  color:var(--muted);
  font-size:.9rem;
  text-align:center;
  margin-top:.5rem;
}

/* Tables */
table{width:100%;border-collapse:collapse;font-family:var(--sans);font-size:.98rem}
th,td{padding:.65rem .75rem;border-bottom:1px solid var(--border);vertical-align:top}
thead th{text-align:left;color:#0a0a0a;background:#fafafa;font-weight:600}

/* Footnotes */
.footnotes{
  margin-top:3rem;
  border-top:1px solid var(--border);
  padding-top:1rem;
  font-family:var(--sans);
  font-size:.92rem;
  line-height:1.6;
  letter-spacing:.01em;
  color:#333;
}
.footnotes ol{padding-left:1.1rem}
.footnotes li{margin:.4rem 0}

/* Mobile font adjustments */
@media (max-width:520px){
  body{font-size:1rem}
}

/* Image size utilities */
.img-small{max-width:40%!important}
.img-medium{max-width:60%!important}
.img-large{max-width:70%!important}
.img-full{max-width:80%!important}

/* Reduce media size on smaller screens */
@media (max-width:1200px){
  article img,article video,.content img,.content video,img{
    max-width:90%;
  }
  article div[style*="padding-bottom"],.content div[style*="padding-bottom"],
  article iframe,.content iframe{
    max-width:90%;
    margin:auto auto;
  }
}

/* Visually hidden utility */
.sr-only{
  position:absolute!important;
  width:1px;height:1px;
  padding:0;margin:-1px;
  overflow:hidden;
  clip:rect(0 0 0 0);
  white-space:nowrap;border:0;
}

/* ---------- Site footer ---------- */
.site-footer{
  margin-top:3rem;
  border-top:1px solid var(--border);
}
.site-footer .container{
  padding:1rem clamp(10px, 1.6vw, 18px) 2rem;
}
.site-footer__text{
  margin:.25rem 0 0;
  font-size:var(--step--1);
  text-align:right;
  font-family: var(--mono);
}
.site-footer a{color:inherit;text-decoration:underline;text-underline-offset:2px}
.site-footer a:hover{color:var(--ink)}
